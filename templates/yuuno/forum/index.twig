{% extends 'global/master.twig' %}

{% set title = 'Forums' %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
    <div class="content homepage forum">
        <div class="content-right content-column">
            <div id="forumIndexPopularThreads">
                <div class="head">Popular threads</div>
                <table class="panelTable" style="border-spacing: 0;">
                    <tr>
                        <th>Title</th>
                        <th>Last reply</th>
                    </tr>
                    {% for _t in activeThreads %}
                        <tr {% if _t.unread(user.id) %}style="font-weight: bold;"{% endif %}>
                            <td style="text-align: left; border-bottom: 1px solid #9475b2;">
                                <a href="{{ route('forums.thread', _t.id) }}" class="default">{{ _t.title }}</a>
                            </td>
                            <td class="rightAlign" style="border-bottom: 1px solid #9475b2;"><time>{{ _t.lastPost.time|date(sakura.dateFormat) }}</time></td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
            <div id="forumIndexNewPosts">
                <div class="head">Latest posts</div>
                <table class="panelTable" style="border-spacing: 0;">
                    <tr>
                        <th>Title &amp; user</th>
                        <th>Posted</th>
                    </tr>
                    {% for _p in latestPosts %}
                        <tr {% if _p.unread(user.id) %}style="font-weight: bold;"{% endif %}>
                            <td style="text-align: left; border-bottom: 1px solid #9475b2;">
                                <a href="{{ route('forums.post', _p.id) }}" class="default">{{ _p.subject }}</a>
                                by
                                <a href="{{ route('user.profile', _p.poster.id) }}" class="default"><span style="color: {{ _p.poster.colour }};">{{ _p.poster.username }}</span></a>
                            </td>
                            <td class="rightAlign" style="border-bottom: 1px solid #9475b2;"><time>{{ _p.time|date(sakura.dateFormat) }}</time></td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
            <div id="forumMostActivePoster">
                <div class="head">Today's most active poster</div>
                <a class="clean" href="{{ route('user.profile', activePoster.id) }}">
                    <div class="user-container" style="background-image: url({{ route('user.header', activePoster.id) }});">
                        <div class="default-avatar-setting user-container-avatar" style="background-image: url({{ route('file.avatar', activePoster.id) }}); box-shadow: 0 0 5px #{% if activePoster.isOnline %}484{% else %}844{% endif %};"></div>
                        <div class="user-container-info">
                            <h1 style="color: {{ activePoster.colour }}; text-shadow: 0 0 7px {% if activePoster.colour != 'inherit' %}{{ activePoster.colour }}{% else %}#222{% endif %}; padding: 0 0 2px;" {% if activePoster.getUsernameHistory %} title="Known as {{ activePoster.getUsernameHistory[0].username_old }} before {{ activePoster.getUsernameHistory[0].change_time|date(sakura.dateFormat) }}." {% endif %}>{{ activePoster.username }}</h1>
                            {% if activePoster.isPremium[0] %}<img src="{{ sakura.contentPath }}/images/tenshi.png" alt="Tenshi" style="vertical-align: middle;" /> {% endif %}<img src="{{ sakura.contentPath }}/images/flags/{{ activePoster.country|lower }}.png" alt="{{ activePoster.country }}" style="vertical-align: middle;" title="{{ activePoster.country(true) }}" /> <span style="font-size: .8em;">{{ activePoster.title }}</span>
                        </div>
                    </div>
                </a>
            </div>
        </div>
        <div class="content-left content-column">
            {% include 'forum/forum.twig' %}
        </div>
        <div class="clear"></div>
    </div>
{% endblock %}
